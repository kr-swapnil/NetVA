---
title: "NetVA: an R package for network vulnerability and influence analysis"
author: "Swapnil Kumar, Grace Pauline, and Vaibhav Vindal^[Department of Biotechnology & Bioinformatics, University of Hyderabad, India.]"
date: "`r Sys.Date()`"
output: rmarkdown::html_vignette
#output: pdf_document
vignette: >
  %\VignetteIndexEntry{NetVA: an R package for network vulnerability and influence analysis}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

`NetVA` is a fast and open source library/package for the analysis of networks. The package consists of a core written in [R](https://github.com/kr-swapnil/NetVA). This vignette aims to give you an overview of the functions available in the `NetVA` package.

***
**NOTE:** Throughout this tutorial, we will use words `graph` and `network` as synonyms, and also `vertex`, `node` or 'protein' as synonyms.

***

## Installation
To install the package from GitHub, use either:
```{r echo = TRUE, eval = FALSE}
install.packages("remotes")
remotes::install_github("kr-swapnil/NetVA")
```
or
```{r echo = TRUE, eval = FALSE}
install.packages("devtools")
devtools::install_github("kr-swapnil/NetVA")
```

More details on dependencies, requirements, and troubleshooting on installation are found on the main [documentation page](https://github.com/kr-swapnil/NetVA).

## Usage
To use `NetVA` in your R code, you must first load the package:

```{r echo = FALSE}
knitr::opts_chunk$set(fig.width=6, fig.height=6)
```

```{r setup}
library("NetVA")
```

Now you have all `NetVA` functions available.

##```{r setup, include = FALSE}
##knitr::opts_chunk$set(
##  collapse = TRUE,
##  comment = "#>"
##)
##```

## Network vulnerability analysis
`NetVA` offers `netva` function to perform vulnerability analysis of any given network, e.g., a protein-protein interaction network:

```{r}
#Load protein-protein interactions of breast cancer available within this package as igraph object:
data(bca_ppi)
bc.net <- bca_ppi

#Read graph/network from TXT and CSV files:
#From TXT file, it should not have header/column names
#bc.net <- read.graph("BRCA_100ppi.txt", format = "ncol")

#Convert a data.frame to a graph object:
#From TXT/CSV file, if TXT/CSV file has header/column names, then head = TRUE
#bc.net <- read.table("BRCA_100ppi.txt", head = FALSE) #TXT to data.frame
#bc.net <- read.csv("BRCA_100ppi.csv", head = FALSE) #CSV to data.frame

#bc.net <- graph.data.frame(bc.net, directed = FALSE) #data.frame to graph object

#Store name of all vertices in vl as character vector
vl <- vertex_attr(bc.net)$name

#Run netva using single core/default option for one protein or more than one protein at once
##Compatible with all Linux, macOS, and Windows machines
## Syntax: netva(vl, net, ncore = 1), where vl is the vector or list of nodes, node pairs, or node triplets, net is the network from which nodes will be deleted, and ncore is the number of cores for parallel processing by forking the job in multiple parts.

netva.res <- netva(vl[c(1, 6)], bc.net) #Two proteins, i.e., 1st and 6th at once
netva.res <- netva(vl[c(1, 3, 7)], bc.net) #Three proteins, i.e., 1st, 3rd, and 7th at once

#Run netva using single core/default option for all proteins one by one individually (compatible with all Linux, macOS, and Windows machines)
#netva.res <- netva(vl, bc.net)

#Run netva using multiple core option for all proteins one by one individually (compatible only with all Linux and macOS machines)
#netva.res <- netva(vl, bc.net, ncore = 30)

#Detect vulnerable proteins (VPs) based on each property one by one
## Syntax: detect(v, t, p), where v is the vector of node/protein names, t is the vector of topological property values for all nodes with same length and order of values as of v, and p is the three letter keyword for corresponding topological property.

#abc.outliers <- detectVNs(vl, netva.res[,1], "ABC") #Average betweenness
#acc.outliers <- detectVNs(vl, netva.res[,2], "ACC") #Average closeness
#aec.outliers <- detectVNs(vl, netva.res[,3], "AEC") #Average eccentricity
#anc.outliers <- detectVNs(vl, netva.res[,4], "ANC") #Average node connectivity
#apl.outliers <- detectVNs(vl, netva.res[,5], "APL") #Average path length
#apn.outliers <- detectVNs(vl, netva.res[,6], "APN") #Articulation point
#cco.outliers <- detectVNs(vl, netva.res[,7], "CCO") #Clustering coefficient
#coh.outliers <- detectVNs(vl, netva.res[,8], "COH") #Cohesiveness
#com.outliers <- detectVNs(vl, netva.res[,9], "COM") #Compactness
#gef.outliers <- detectVNs(vl, netva.res[,10], "GEF") #Global efficiency
#het.outliers <- detectVNs(vl, netva.res[,11], "HET") #Heterogeneity
#nce.outliers <- detectVNs(vl, netva.res[,12], "NCE") #Network centralization
#nde.outliers <- detectVNs(vl, netva.res[,13], "NDE") #Network density
#ndi.outliers <- detectVNs(vl, netva.res[,14], "NDI") #Network diameter

#Vulnerability analysis for the detection of vulnerable node/protein pairs (VPPs)
##(1) For random pairs of nodes which may or may not be connected with each other in the network
np.list = combn(vl[1:100], 2, simplify = FALSE)
length(np.list)
#netva.res <- netva(np.list, bc.net, ncore = 30)

##(2) For those pairs of nodes that are connected with each other in the network
###Detection of connected pairs of nodes in the network (only for hundred nodes)
vl2 = t(combn(vl[1:100], 2))
dim(vl2)
np.list = list()
l = 0
#for(i in 1:dim(vl2)[1]){
#	k = are_adjacent(bc.net, vl2[i,1], vl2[i,2])
#	if(k == TRUE){
#		l = l + 1
#		np.list[[l]] = as.character(vl2[i,])
#	}
#}
length(np.list)
#netva.res <- netva(np.list, bc.net, ncore = 30)

#Detect vulnerable protein pairs (VPPs) based on each property one by one
#abc.outliers <- detectVNs(rownames(netva.res), netva.res[,1], "ABC") #Average betweenness
#acc.outliers <- detectVNs(rownames(netva.res), netva.res[,2], "ACC") #Average closeness
#aec.outliers <- detectVNs(rownames(netva.res), netva.res[,3], "AEC") #Average eccentricity
#anc.outliers <- detectVNs(rownames(netva.res), netva.res[,4], "ANC") #Average node connectivity
#apl.outliers <- detectVNs(rownames(netva.res), netva.res[,5], "APL") #Average path length
#apn.outliers <- detectVNs(rownames(netva.res), netva.res[,6], "APN") #Articulation point
#nce.outliers <- detectVNs(rownames(netva.res), netva.res[,7], "NCE") #Network centralization
#cco.outliers <- detectVNs(rownames(netva.res), netva.res[,8], "CCO") #Clustering coefficient
#coh.outliers <- detectVNs(rownames(netva.res), netva.res[,9], "COH") #Cohesiveness
#com.outliers <- detectVNs(rownames(netva.res), netva.res[,10], "COM") #Compactness
#gef.outliers <- detectVNs(rownames(netva.res), netva.res[,11], "GEF") #Global efficiency
#het.outliers <- detectVNs(rownames(netva.res), netva.res[,12], "HET") #Heterogeneity
#nde.outliers <- detectVNs(rownames(netva.res), netva.res[,13], "NDE") #Network density
#ndi.outliers <- detectVNs(rownames(netva.res), netva.res[,14], "NDI") #Network diameter
```

Three letter keywords for corresponding topological properties include the following:

| Keyword                   | Topology                                         |
|---------------------------|--------------------------------------------------|
| `APN`                     | Articulation point                               |
| `ABC`                     | Average betweenness centrality                   |
| `ACC`                     | Average closeness centrality                     |
| `AEC`                     | Average eccentricity                             |
| `APL`                     | Average path length                              |
| `ANC`                     | Average node connectivity                        |
| `CCO`                     | Clustering coefficient                           |
| `COH`                     | Cohesiveness                                     |
| `COM`                     | Compactness                                      |
| `GEF`                     | Global efficiency                                |
| `HET`                     | Heterogeneity                                    |
| `NCE`                     | Network centralization                           |
| `NDE`                     | Network density                                  |
| `NDI`                     | Network diameter                                 |


## Network influence analysis
`NetVA` offers `evc` and `detectINs` functionality to perform influence analysis of any given network, e.g., a protein-protein interaction network:
```{r}
#Calculate the values of EVC and EVC+ for all nodes present in the network:
#evc.res = evc(bc.net)

#Detect influential proteins (IPs) based on EVC and EVC+:
#ip.list = detectINs(bc.net)
```

## Hubs and bottlenecks in a network
`NetVA` offers `detectHubs` and `detectBottlenecks` function to identify Hubs for a given network, e.g., a protein-protein interaction network:
```{r}
#hubs <- detectHubs(net = bc.net, method = "ETP", p = 20, validate = TRUE, perturb = 5, iter = round(100/perturb), ng = iter)

hubs <- detectHubs(net = bc.net)
head(hubs)
```

```{r}
#bots <- detectBottlenecks(net = bc.net, method = "ETP", p = 20, validate = TRUE, perturb = 5, iter = round(100/perturb), ng = iter)

bots <- detectBottlenecks(net = bc.net)
head(bots)
```

## Heterogeneity of networks
`NetVA` offers `netva` function to perform vulnerability analysis of any given network, e.g., a protein-protein interaction network:
```{r}
#Calculate the value of heterogeneity of a network:
net.het <- heterogeneity(bc.net)
```

## Cohesiveness and compactness of networks
`NetVA` offers functionality to calculate Cohesiveness and Compactness of any given network, e.g., a protein-protein interaction network:
```{r}
#Cohesiveness of complete network:
#coh.cent <- cohesiveness(net = bc.net)

#Cohesiveness of a network after removal of a particular node, e.g., "UBC":
#coh.cent <- cohesiveness(v = "UBC", net = bc.net)
```

```{r}
#Compactness of complete network:
#com.cent <- compactness(net = bc.net)

#Compactness of a network after removal of a particular node, e.g., "UBC":
#com.cent <- compactness(v = "UBC", net = bc.net)
```

## Where to go next

This tutorial is a brief introduction to `NetVA`. We sincerely hope you enjoyed reading it and that it will be useful for your own network analyses.

For a detailed description of specific functions, see corresponding help documentation using `help` function  and <https://github.com/kr-swapnil/NetVA>. To report a bug, open a [Github issue](https://github.com/kr-swapnil/NetVA/issues). Please do not ask usage questions on Github directly.

## Session info

For the sake of reproducibility, the session information for the code above is the following:

```{r session-info}
sessionInfo()
```
